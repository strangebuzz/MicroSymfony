{% extends 'base.html.twig' %}

{% block body %}
    <h2>Doctrine demo</h2>

    <p>The page displays the <code>user</code> table rows coming from the <code>var/data.db</code> SQLite database.</p>

    <h3>Doctrine DBAL</h3>

    <code>
        usersDbal: $this->conn->fetchAllAssociative('SELECT * FROM user'),
    </code>

    <table class="striped">
        <thead>
        <tr>
            <th>Id</th>
            <th>Email</th>
            <th>Pseudo</th>
            <th>Created at</th>
            <th>Updated at</th>
        </tr>
        </thead>
        <tbody>
        {% for user in data.usersDbal %}
            <tr>
                <td>{{ user.id }}</td>
                <td>{{ user.email }}</td>
                <td>{{ user.username }}</td>
                <td>{{ user.created_at|date(constant('DateTime::RSS')) }}</td>
                <td>{{ user.updated_at|date(constant('DateTime::RSS')) }}</td>
            </tr>
        {% endfor %}
        </tbody>
        <tfoot>
            <tr>
                <th colspan="5" scope="row">
                    There are <b>{{ data.usersDbal|length }}</b> user(s).
                </th>
            </tr>
        </tfoot>
    </table>

    <hr/>

    <h3>Doctrine ORM</h3>

    <code>
        usersOrm: $this->userRepository->findAll(),
    </code>

    <table class="striped">
        <thead>
        <tr>
            <th>Id</th>
            <th>Email</th>
            <th>Pseudo</th>
            <th>Created at</th>
            <th>Updated at</th>
        </tr>
        </thead>
        <tbody>
        {% for user in data.usersOrm %}
            <tr>
                <td>{{ user.id }}</td>
                <td>{{ user.email }}</td>
                <td>{{ user.username }}</td>
                <td>{{ user.createdAt|date(constant('DateTime::RSS')) }}</td>
                <td>{{ user.updatedAt|date(constant('DateTime::RSS')) }}</td>
            </tr>
        {% endfor %}
        </tbody>
        <tfoot>
            <tr>
                <th colspan="5" scope="row">
                    There are <b>{{ data.usersOrm|length }}</b> user(s).
                </th>
            </tr>
        </tfoot>
    </table>
{% endblock %}
